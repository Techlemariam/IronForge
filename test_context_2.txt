
[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90mC:/Users/alexa/Workspaces/IronForge[39m

[90mstdout[2m | src/services/data/__tests__/TrainingContextService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (2) from .env.test -- tip: Â­Æ’Ã¶Ã‰ encrypt with Dotenvx: https://dotenvx.com

[90mstdout[2m | src/services/data/__tests__/TrainingContextService.test.ts[2m > [22m[2mTrainingContextService[2m > [22m[2mgetTrainingContext[2m > [22m[2mshould return context with readiness and volume
[22m[39mAutoSpec: Evaluating transition from ALPHA {
  ctl: [33m0[39m,
  atl: [33m0[39m,
  tsb: [33m0[39m,
  hrv: [33m80[39m,
  sleepScore: [33m0[39m,
  bodyBattery: [33m90[39m,
  strengthDelta: [33m0[39m,
  consecutiveStalls: [33m0[39m,
  weeksInPhase: [33m0[39m,
  nutritionMode: [32m'MAINTENANCE'[39m,
  sleepDebt: [33m0[39m,
  acwr: [33m1[39m,
  junkMilePercent: [33m0[39m,
  neuralLoad: [33m0[39m,
  impactLoad: [33m0[39m,
  interferenceEvents: [33m0[39m
}

[90mstdout[2m | src/services/data/__tests__/TrainingContextService.test.ts[2m > [22m[2mTrainingContextService[2m > [22m[2mgetTrainingContext[2m > [22m[2mshould trigger warnings for low recovery
[22m[39mAutoSpec: Evaluating transition from ALPHA {
  ctl: [33m0[39m,
  atl: [33m0[39m,
  tsb: [33m0[39m,
  hrv: [33m50[39m,
  sleepScore: [33m0[39m,
  bodyBattery: [33m20[39m,
  strengthDelta: [33m0[39m,
  consecutiveStalls: [33m0[39m,
  weeksInPhase: [33m0[39m,
  nutritionMode: [32m'MAINTENANCE'[39m,
  sleepDebt: [33m0[39m,
  acwr: [33m1[39m,
  junkMilePercent: [33m0[39m,
  neuralLoad: [33m0[39m,
  impactLoad: [33m0[39m,
  interferenceEvents: [33m0[39m
}

[90mstdout[2m | src/services/data/__tests__/TrainingContextService.test.ts[2m > [22m[2mTrainingContextService[2m > [22m[2mgetTrainingContext[2m > [22m[2mshould detect high cardio fatigue
[22m[39mAutoSpec: Evaluating transition from ALPHA {
  ctl: [33m0[39m,
  atl: [33m0[39m,
  tsb: [33m0[39m,
  hrv: [33m0[39m,
  sleepScore: [33m0[39m,
  bodyBattery: [33m80[39m,
  strengthDelta: [33m0[39m,
  consecutiveStalls: [33m0[39m,
  weeksInPhase: [33m0[39m,
  nutritionMode: [32m'MAINTENANCE'[39m,
  sleepDebt: [33m0[39m,
  acwr: [33m1[39m,
  junkMilePercent: [33m0[39m,
  neuralLoad: [33m0[39m,
  impactLoad: [33m0[39m,
  interferenceEvents: [33m0[39m
}

stderr | src/services/data/__tests__/TrainingContextService.test.ts > TrainingContextService > getTrainingContext > should detect high cardio fatigue
AutoSpec: CRITICAL STRESS. FORCE DELOAD.

 [31mÃ”Ã˜Â»[39m src/services/data/__tests__/TrainingContextService.test.ts [2m([22m[2m9 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 22[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should aggregate volume correctly by muscle group[32m 4[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should handle mapped muscle groups if explicit group is missing[32m 0[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should return context with readiness and volume[39m[32m 11[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should trigger warnings for low recovery[32m 1[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should detect high cardio fatigue[39m[32m 2[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return HIGH for Heavy Deadlifts[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return LOW for Light Curls[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return MEDIUM for Moderate Bench[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return HIGH for RPE 10 Squats[32m 0[2mms[22m[39m

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Tests 2 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  src/services/data/__tests__/TrainingContextService.test.ts > TrainingContextService > getTrainingContext > should return context with readiness and volume
AssertionError: expected [ Array(1) ] to have a length of +0 but got 1

- Expected
+ Received

- 0
+ 1

 Ã”Ã˜Â» src/services/data/__tests__/TrainingContextService.test.ts:92:38
     90|             expect(context.readiness).toBe("HIGH");
     91|             expect(context.cnsFatigue).toBe("LOW");
     92|             expect(context.warnings).toHaveLength(0);
       |                                      ^
     93|         });
     94| 

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[1/2]Ã”Ã„Â»

 FAIL  src/services/data/__tests__/TrainingContextService.test.ts > TrainingContextService > getTrainingContext > should detect high cardio fatigue
RangeError: Invalid time value
 Ã”Ã˜Â» src/services/data/TrainingContextService.ts:272:58
    270|         const cardiosByDate = new Map<string, Date[]>();
    271|         recentActivities.forEach(a => {
    272|             const dateStr = new Date(a.start_date_local).toISOString()Ã”Ã‡Âª
       |                                                          ^
    273|             const time = new Date(a.start_date_local);
    274|             if (!cardiosByDate.has(dateStr)) cardiosByDate.set(dateStrÃ”Ã‡Âª
 Ã”Ã˜Â» TrainingContextService.getTrainingContext src/services/data/TrainingContextService.ts:271:26
 Ã”Ã˜Â» src/services/data/__tests__/TrainingContextService.test.ts:121:29

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[2/2]Ã”Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m7 passed[39m[22m[90m (9)[39m
[2m   Start at [22m 10:10:54
[2m   Duration [22m 1.04s[2m (transform 327ms, setup 117ms, import 425ms, tests 22ms, environment 0ms)[22m

